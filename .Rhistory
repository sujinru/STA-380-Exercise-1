source('~/.active-rstudio-document', echo=TRUE)
library(ggplot2)
library(dplyr)
buildings = read.csv('~/Downloads/greenbuildings.csv')
green_buildings = subset(buildings, green_rating==1)
non_green_buildings = subset(buildings, green_rating!=1)
par(mfrow=c(1,2))
hist(green_buildings$leasing_rate, main="Green Buildings", xlab="Leasing Rate", ylab = "")
hist(non_green_buildings$leasing_rate, main="Non-Green Buildings", xlab="Leasing Rate", ylab="",
col=c('red', rep('white',9)))
green_median = green_buildings[green_buildings$Rent == median(green_buildings$Rent),]
nongreen_median = non_green_buildings[non_green_buildings$Rent == median(non_green_buildings$Rent),]
plot(non_green_buildings$age, non_green_buildings$Rent, col="grey", pch=19, cex=0.5, xlab = "Buildings Age", ylab="Annual Rent")
abline(v=mean(nongreen_median$age),col='grey',lwd=2)
abline(v=mean(green_median$age),col='red',lwd=2)
points(green_buildings$age, green_buildings$Rent, col="red", pch=19, cex=0.5)
legend(x=100,y=250,cex=0.7,legend=c('Non-Green buildings','Median Age Non-Green Buildings','Green buildings','Median Age Green Buildings'),lty=c(NA,1,NA,1),pch=c(19,NA,19,NA),col=c('grey','grey','red','red'))
green_median = green_buildings[green_buildings$Rent == median(green_buildings$Rent),]
nongreen_median = non_green_buildings[non_green_buildings$Rent == median(non_green_buildings$Rent),]
plot(non_green_buildings$age, non_green_buildings$Rent, col="grey", pch=19, cex=0.5, xlab = "Buildings Age", ylab="Annual Rent")
abline(v=median(nongreen_median$age),col='grey',lwd=2)
abline(v=median(green_median$age),col='red',lwd=2)
points(green_buildings$age, green_buildings$Rent, col="red", pch=19, cex=0.5)
legend(x=100,y=250,cex=0.7,legend=c('Non-Green buildings','Median Age Non-Green Buildings','Green buildings','Median Age Green Buildings'),lty=c(NA,1,NA,1),pch=c(19,NA,19,NA),col=c('grey','grey','red','red'))
buildings$class = ifelse(buildings$class_a==1, 1, ifelse(buildings$class_b==1, 2, 3))
boxplot(buildings$Rent~buildings$class,outline=FALSE, names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
par(mfrow=c(1,2))
pie_chart = table(buildings$green_rating, buildings$class)
pie(pie_chart[2,], labels = c('Class A', 'Class B', 'Class C'), col=c('azure3','azure2','azure1'), main="Green Buildings")
pie(pie_chart[1,], labels = c('Class A', 'Class B', 'Class C'), col=c('azure3','azure2','azure1'), main="Non-green Buildings", init.angle  = 90)
?boxplot
boxplot(buildings$Rent~buildings$class,outline=FALSE, width=2, names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,  names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,width=c(2,2,2),  names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,width=c(1,2,2),  names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,width=c(1,1,1),  names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5,  names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, border=c('black','black','black'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, border=c('red','black','black'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, border=c('grey','grey','grey'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, border=c('grey','grey','grey'), col='red', names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, border=c('grey','grey','grey'), col='azure', names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, border=c('grey','grey','grey'), col='azure', names = c("Class A", "Class B", "Class C"), main="Rent vs. Class", horizontal=TRUE)
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, border=c('grey','grey','grey'), col='azure', names = c("Class A", "Class B", "Class C"), main="Rent vs. Class", horizontal=TRUE, las=2)
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, border=c('grey','grey','grey'), col='azure', names = c("Class A", "Class B", "Class C"), main="Rent vs. Class", las=2)
)
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, border=c('grey','grey','grey'), col='azure', names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, border=c('firebrick1','grey','grey'), col='azure', names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col='azure', names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col='salmon', names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
green_median = green_buildings[green_buildings$Rent == median(green_buildings$Rent),]
nongreen_median = non_green_buildings[non_green_buildings$Rent == median(non_green_buildings$Rent),]
plot(non_green_buildings$age, non_green_buildings$Rent, col="grey", pch=19, cex=0.5, xlab = "Buildings Age", ylab="Annual Rent")
abline(v=median(nongreen_median$age),col='grey',lwd=2)
abline(v=median(green_median$age),col='salmon',lwd=2)
points(green_buildings$age, green_buildings$Rent, col="red", pch=19, cex=0.5)
legend(x=100,y=250,cex=0.7,legend=c('Non-Green buildings','Median Age Non-Green Buildings','Green buildings','Median Age Green Buildings'),lty=c(NA,1,NA,1),pch=c(19,NA,19,NA),col=c('grey','grey','red','red'))
green_median = green_buildings[green_buildings$Rent == median(green_buildings$Rent),]
nongreen_median = non_green_buildings[non_green_buildings$Rent == median(non_green_buildings$Rent),]
plot(non_green_buildings$age, non_green_buildings$Rent, col="grey", pch=19, cex=0.5, xlab = "Buildings Age", ylab="Annual Rent")
abline(v=median(nongreen_median$age),col='grey',lwd=2)
abline(v=median(green_median$age),col='salmon',lwd=2)
points(green_buildings$age, green_buildings$Rent, col="salmon", pch=19, cex=0.5)
legend(x=100,y=250,cex=0.7,legend=c('Non-Green buildings','Median Age Non-Green Buildings','Green buildings','Median Age Green Buildings'),lty=c(NA,1,NA,1),pch=c(19,NA,19,NA),col=c('grey','grey','salmon','salmon'))
green_median = green_buildings[green_buildings$Rent == median(green_buildings$Rent),]
nongreen_median = non_green_buildings[non_green_buildings$Rent == median(non_green_buildings$Rent),]
plot(non_green_buildings$age, non_green_buildings$Rent, col="grey", pch=19, cex=0.5, xlab = "Buildings Age", ylab="Annual Rent")
abline(v=median(nongreen_median$age),col='grey',lwd=2)
abline(v=median(green_median$age),col='red',lwd=2)
points(green_buildings$age, green_buildings$Rent, col="red", pch=19, cex=0.5)
legend(x=100,y=250,cex=0.7,legend=c('Non-Green buildings','Median Age Non-Green Buildings','Green buildings','Median Age Green Buildings'),lty=c(NA,1,NA,1),pch=c(19,NA,19,NA),col=c('grey','grey','red','red'))
library(caret)
#library(caret)
library(randomForest)
library(ggplot2)
library(magrittr)
library(scales)
library(pander)
library(gridExtra)
df <- read.csv("~/Downloads/greenbuildings.csv")
df$green_rating <- as.factor(df$green_rating)
green_bld <- subset(df, df["green_rating"]==1)
non_green_bld <- subset(df, df["green_rating"]==0)
all_names <- names(df)
vec_names <- c("Rent", "NULL")
green_central_rent <- c(mean(green_bld$Rent),median(green_bld$Rent))
non_green_central_rent <- c(mean(non_green_bld$Rent),median(non_green_bld$Rent))
rent_central <- data.frame(rbind(green_central_rent,non_green_central_rent))
rownames(rent_central) <- c("Green", "Non Green")
colnames(rent_central) <- c("Mean Rent", "Median Rent")
pander(rent_central)
green_central_gas <- c(mean(green_bld$Gas_Costs),median(green_bld$Gas_Costs))
non_green_central_gas <- c(mean(non_green_bld$Gas_Costs),median(non_green_bld$Gas_Costs))
gas_central <- data.frame(rbind(green_central_gas,non_green_central_gas))
rownames(gas_central) <- c("Green", "Non Green")
colnames(gas_central) <- c("Mean Gas Cost", "Median Gas Cost")
pander(gas_central)
#Again potential confounding
green_central_elec <- c(mean(green_bld$Electricity_Costs),median(green_bld$Electricity_Costs))
non_green_central_elec <- c(mean(non_green_bld$Electricity_Costs),median(non_green_bld$Electricity_Costs))
elec_central <- data.frame(rbind(green_central_elec,non_green_central_elec))
rownames(elec_central) <- c("Green", "Non Green")
colnames(elec_central) <- c("Mean Electricity Cost", "Median Electricity Cost")
pander(elec_central)
ggplot(df, aes(x=Rent, y = ..density..))+
geom_histogram(bins = 100, color ="white", fill = "bisque2")+ geom_density(size=1, colour='white')+ ggtitle("Distribution of Rent Values") +
geom_vline(aes(xintercept=mean(df$Rent), colour="Mean"),size =1,  show.legend = TRUE) +
geom_vline(aes(xintercept=median(df$Rent), colour="Median"), size =1 , show.legend = TRUE) +
scale_colour_manual(name="",values=c("Mean"= "firebrick", "Median"="cyan4"))
ggplot(green_bld, aes(x=Rent, y = ..density..))+
geom_histogram(bins = 100, color ="white", fill = "bisque2")+ geom_density(size=1, colour='white')+ ggtitle("Distribution of Rent Values") +
geom_vline(aes(xintercept=mean(df$Rent), colour="Mean"),size =1,  show.legend = TRUE) +
geom_vline(aes(xintercept=median(df$Rent), colour="Median"), size =1 , show.legend = TRUE) +
scale_colour_manual(name="",values=c("Mean"= "firebrick", "Median"="cyan4"))
ggplot(non_green_bld, aes(x=Rent, y = ..density..))+
geom_histogram(bins = 100, color ="white", fill = "bisque2")+ geom_density(size=1, colour='white')+ ggtitle("Distribution of Rent Values") +
geom_vline(aes(xintercept=mean(df$Rent), colour="Mean"),size =1,  show.legend = TRUE) +
geom_vline(aes(xintercept=median(df$Rent), colour="Median"), size =1 , show.legend = TRUE) +
scale_colour_manual(name="",values=c("Mean"= "firebrick", "Median"="cyan4"))
alpha_vector <- rep(0.8, nrow(df))
alpha_vector[which(df$green_rating == 1)] <- 1
df$alpha <- alpha_vector
ggplot(df, aes(x =age, y = Rent, col=factor(green_rating,labels = c("Non Green","Green")))) +
geom_point(aes(alpha = alpha)) +
scale_color_manual(values=c("orange","limegreen"))+ labs(color="Type") + scale_alpha(guide = 'none')
g_class_a <- sum(green_bld$class_a ==1)
g_class_b <- sum(green_bld$class_b ==1)
g_class_c <- sum((green_bld$class_a == 0) & (green_bld$class_b ==0))
ng_class_a <- sum(non_green_bld$class_a ==1)
ng_class_b <- sum(non_green_bld$class_b ==1)
ng_class_c <- sum((non_green_bld$class_a == 0) & (non_green_bld$class_b ==0))
class_df <- data.frame(cbind(c(g_class_a,g_class_b,g_class_c)/nrow(green_bld),c(ng_class_a,ng_class_b,ng_class_c)/nrow(non_green_bld)))
class_df <- cbind(class_df, c("Class A", "Class B", "Class C"))
rownames(class_df) <- c("Class A", "Class B", "Class C")
colnames(class_df) <- c("Green", "Non_Green", "class")
Percent_of_Each_Class <- ""
ng_class_c<- sum((non_green_bld$class_a == 0) & (non_green_bld$class_b ==0))
p1<- ggplot(class_df[,c(1,3)], aes(x = Percent_of_Each_Class, y=Green, fill=class))+
geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0)+
geom_text(aes(y = Green/1.5, label = percent(Green)), size=4)
p2 <- ggplot(class_df[,c(2,3)], aes(x = Percent_of_Each_Class, y=Non_Green, fill=class))+
geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0)+
geom_text(aes(y = Non_Green/3 +  c(0, cumsum(Non_Green)[-length(Non_Green)]), label = percent(Non_Green)), size=4)
grid.arrange(p1, p2, ncol=2)
library(ggplot)
library(ggplot2)
pie(pie_chart[2,], labels = c('Class A', 'Class B', 'Class C'), col=c('4D4D4D','azure2','azure1'), main="Green Buildings")
pie(pie_chart[2,], labels = c('Class A', 'Class B', 'Class C'), col=c('grey','blue','orange'), main="Green Buildings")
pie(pie_chart[2,], labels = c('Class A', 'Class B', 'Class C'), col=c('deepskyblue','blue','orange'), main="Green Buildings")
pie(pie_chart[2,], labels = c('Class A', 'Class B', 'Class C'), col=c('deepskyblue','gold','grey'), main="Green Buildings")
buildings$class = ifelse(buildings$class_a==1, 1, ifelse(buildings$class_b==1, 2, 3))
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col='salmon', names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
library(ggplot2)
par(mfrow=c(1,2))
pie_chart = table(buildings$green_rating, buildings$class)
pie(pie_chart[2,], labels = c('Class A', 'Class B', 'Class C'), col=c('deepskyblue','gold','grey'), main="Green Buildings")
pie(pie_chart[1,], labels = c('Class A', 'Class B', 'Class C'), col=c('deepskyblue','gold','grey'), main="Non-green Buildings", init.angle  = 90)
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col=c('gold','gold1','gold2'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col=c('gold','gold2','gold4'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col=c('gold','gold2','gold2'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col=c('gold2','gold2','gold2'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
buildings$class = ifelse(buildings$class_a==1, 1, ifelse(buildings$class_b==1, 2, 3))
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col=c('gold2','gold2','gold2'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
library(ggplot2)
par(mfrow=c(1,2))
pie_chart = table(buildings$green_rating, buildings$class)
pie(pie_chart[2,], labels = c('Class A', 'Class B', 'Class C'), col=c('deepskyblue','gold','grey'), main="Green Buildings")
pie(pie_chart[1,], labels = c('Class A', 'Class B', 'Class C'), col=c('deepskyblue','gold','grey'), main="Non-green Buildings", init.angle  = 90)
pie_chart
pie(pie_chart[2,], labels = c('Class A: 80%', 'Class B', 'Class C'), col=c('deepskyblue','gold','grey'), main="Green Buildings")
pie(pie_chart[1,], labels = c('Class A:', 'Class B', 'Class C'), col=c('deepskyblue','gold','grey'), main="Non-green Buildings", init.angle  = 90)
2611/(2611+3495+1103)
132/(2611+3495+1103)
3495/(2611+3495+1103)
1103/(2611+3495+1103)
buildings$class = ifelse(buildings$class_a==1, 1, ifelse(buildings$class_b==1, 2, 3))
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col=c('gold2','gold2','gold2'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
library(ggplot2)
par(mfrow=c(1,2))
pie_chart = table(buildings$green_rating, buildings$class)
pie(pie_chart[2,], labels = c('Class A: 80%', 'Class B: 19%', 'Class C: 1%'), col=c('deepskyblue','gold','grey'), main="Green Buildings")
pie(pie_chart[1,], labels = c('Class A: 36%', 'Class B: 48%', 'Class C: 15%'), col=c('deepskyblue','gold','grey'), main="Non-green Buildings", init.angle  = 90)
pie(pie_chart[2,], labels = c('Class A: 80%', 'Class B: 19%', 'Class C: 1%'), col=c('deepskyblue','gold','grey'), main="Green Buildings", init.angle = 45)
buildings$class = ifelse(buildings$class_a==1, 1, ifelse(buildings$class_b==1, 2, 3))
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col=c('gold2','gold2','gold2'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
library(ggplot2)
par(mfrow=c(1,2))
pie_chart = table(buildings$green_rating, buildings$class)
pie(pie_chart[2,], labels = c('Class A: 80%', 'Class B: 19%', 'Class C: 1%'), col=c('deepskyblue','gold','grey'), main="Green Buildings", init.angle = 180)
pie(pie_chart[1,], labels = c('Class A: 36%', 'Class B: 48%', 'Class C: 15%'), col=c('deepskyblue','gold','grey'), main="Non-green Buildings", init.angle  = 90)
buildings$class = ifelse(buildings$class_a==1, 1, ifelse(buildings$class_b==1, 2, 3))
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col=c('gold2','gold2','gold2'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
library(ggplot2)
par(mfrow=c(1,2))
pie_chart = table(buildings$green_rating, buildings$class)
pie(pie_chart[2,], labels = c('Class A: 80%', 'Class B: 19%', 'Class C: 1%'), col=c('deepskyblue','gold','grey'), main="Green Buildings", init.angle = 210)
pie(pie_chart[1,], labels = c('Class A: 36%', 'Class B: 48%', 'Class C: 15%'), col=c('deepskyblue','gold','grey'), main="Non-green Buildings", init.angle  = 90)
buildings$class = ifelse(buildings$class_a==1, 1, ifelse(buildings$class_b==1, 2, 3))
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col=c('gold2','gold2','gold2'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
library(ggplot2)
par(mfrow=c(1,2))
pie_chart = table(buildings$green_rating, buildings$class)
pie(pie_chart[2,], labels = c('Class A: 80%', 'Class B: 19%', 'Class C: 1%'), col=c('deepskyblue','gold','grey'), main="Green Buildings", init.angle = 150)
pie(pie_chart[1,], labels = c('Class A: 36%', 'Class B: 48%', 'Class C: 15%'), col=c('deepskyblue','gold','grey'), main="Non-green Buildings", init.angle  = 90)
buildings$class = ifelse(buildings$class_a==1, 1, ifelse(buildings$class_b==1, 2, 3))
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col=c('gold2','gold2','gold2'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
library(ggplot2)
par(mfrow=c(1,2))
pie_chart = table(buildings$green_rating, buildings$class)
pie(pie_chart[2,], labels = c('Class A: 80%', 'Class B: 19%', 'Class C: 1%'), col=c('deepskyblue','gold','grey'), main="Green Buildings", init.angle = 150)
pie(pie_chart[1,], labels = c('Class A: 36%', 'Class B: 48%', 'Class C: 15%'), col=c('deepskyblue','gold','grey'), main="Non-green Buildings", init.angle  = 90)
green_buildings_con = subset(green_buildings, age<=50 & (class_a==1 | class_b==1))
non_green_buildings_con = subset(non_green_buildings, age<=50 & (class_a==1 | class_b==1))
non_green_clusters<- non_green_buildings_con%>%
group_by(cluster)%>%
summarise(rent_mean = mean(Rent),
rent_median = median(Rent))
green_clusters<- green_buildings_con%>%
group_by(cluster)%>%
summarise(rent_mean_g = mean(Rent),
rent_median_g = median(Rent))
rent_clusters = merge(x=non_green_clusters, y=green_clusters, by="cluster", all.y = TRUE)
rent_clusters$median_premium = rent_clusters$rent_median_g - rent_clusters$rent_median
mean(rent_clusters$median_premium, na.rm = TRUE)
library(kknn)
buildings_con = subset(buildings, age<=50&(class_a==1 | class_b==1))
buildings_con$LR = buildings_con$leasing_rate * buildings_con$Rent
model = train.kknn(LR ~ age, data = buildings_con, ks= 20)
newdata = as.data.frame(seq(1, 50))
colnames(newdata) = c("age")
predictions = predict(model, newdata)
plot(buildings_con$age, buildings_con$LR,pch=19, cex=0.8,ylab= "LR", xlab="Age", col="darkgray", main = "Total revenue")
lines(newdata$age, predictions, type="l", col='red', lwd=2)
legend(32, 20000, c("KNN Regression"), lwd=2.5,col="red")
library(kknn)
buildings_con = subset(buildings, age<=50&(class_a==1 | class_b==1))
buildings_con$LR = buildings_con$leasing_rate * buildings_con$Rent
model = train.kknn(LR ~ age, data = buildings_con, ks= 200)
newdata = as.data.frame(seq(1, 50))
colnames(newdata) = c("age")
predictions = predict(model, newdata)
plot(buildings_con$age, buildings_con$LR,pch=19, cex=0.8,ylab= "LR", xlab="Age", col="darkgray", main = "Total revenue")
lines(newdata$age, predictions, type="l", col='red', lwd=2)
legend(32, 20000, c("KNN Regression"), lwd=2.5,col="red")
library(kknn)
buildings_con = subset(buildings, age<=50&(class_a==1 | class_b==1))
buildings_con$LR = buildings_con$leasing_rate * buildings_con$Rent
model = train.kknn(LR ~ age, data = buildings_con, ks= 20)
newdata = as.data.frame(seq(1, 50))
colnames(newdata) = c("age")
predictions = predict(model, newdata)
plot(buildings_con$age, buildings_con$LR,pch=19, cex=0.8,ylab= "LR", xlab="Age", col="darkgray", main = "Total revenue")
lines(newdata$age, predictions, type="l", col='red', lwd=2)
legend(32, 20000, c("KNN Regression"), lwd=2.5,col="red")
hist(green_buildings_con$leasing_rate)
hist(green_buildings_con$leasing_rate, breaks = 50)
hist(green_buildings_con, breaks = 50, ylab='', main='Leasing Rate for ')
hist(green_buildings$leasing_rate, breaks = 50, ylab='', main='Leasing Rate for ')
hist(green_buildings$leasing_rate, breaks = 50, ylab='', main='Leasing Rate for Green Buildings')
hist(green_buildings$leasing_rate, breaks = 50, ylab='', main='Leasing Rate for Green Buildings', xlab='')
median(green_buildings$leasing_rate)
rent_clusters
mean(rent_clusters$rent_median_g)
5000/175
hist(green_buildings$age)
5000000/162575
par(mfrow=c(1,2))
hist(green_buildings$leasing_rate, main="Green Buildings", xlab="Leasing Rate", ylab = "")
hist(non_green_buildings$leasing_rate, main="Non-Green Buildings", xlab="Leasing Rate", ylab="",
col=c('red', rep('white',9)))
par(mfrow=c(1,2))
hist(green_buildings$leasing_rate, main="Green Buildings", xlab="Leasing Rate", ylab = "")
hist(non_green_buildings$leasing_rate, main="Non-Green Buildings", xlab="Leasing Rate", ylab="",
col=c('red', rep('white',9)))
buildings$class = ifelse(buildings$class_a==1, 1, ifelse(buildings$class_b==1, 2, 3))
boxplot(buildings$Rent~buildings$class,outline=FALSE,boxwex=0.5, col=c('gold2','gold2','gold2'), names = c("Class A", "Class B", "Class C"), main="Rent vs. Class")
library(ggplot2)
par(mfrow=c(1,2))
pie_chart = table(buildings$green_rating, buildings$class)
pie(pie_chart[2,], labels = c('Class A: 80%', 'Class B: 19%', 'Class C: 1%'), col=c('deepskyblue','gold','grey'), main="Green Buildings", init.angle = 150)
pie(pie_chart[1,], labels = c('Class A: 36%', 'Class B: 48%', 'Class C: 16%'), col=c('deepskyblue','gold','grey'), main="Non-green Buildings", init.angle  = 90)
green_buildings_con = subset(green_buildings, age<=50 & (class_a==1 | class_b==1))
non_green_buildings_con = subset(non_green_buildings, age<=50 & (class_a==1 | class_b==1))
library(kknn)
buildings_con = subset(buildings, age<=50&(class_a==1 | class_b==1))
buildings_con$LR = buildings_con$leasing_rate * buildings_con$Rent
model = train.kknn(LR ~ age, data = buildings_con, ks= 20)
newdata = as.data.frame(seq(1, 50))
colnames(newdata) = c("age")
predictions = predict(model, newdata)
plot(buildings_con$age, buildings_con$LR,pch=19, cex=0.8,ylab= "LR", xlab="Age", col="darkgray", main = "Total revenue")
lines(newdata$age, predictions, type="l", col='red', lwd=2)
legend(32, 20000, c("KNN Regression"), lwd=2.5,col="red")
hist(green_buildings$leasing_rate, breaks = 50, xlim=c(40, 100), ylab='', main='Leasing Rate for Green Buildings', xlab='')
hist(green_buildings$leasing_rate, breaks = 50, xlim=c(40, 100), ylab='', main='Leasing Rate for Green Buildings', xlab='')
hist(green_buildings_con$leasing_rate, breaks = 50, xlim=c(40, 100), ylab='', main='Leasing Rate for Green Buildings', xlab='')
hist(green_buildings_con$leasing_rate, breaks = 50, ylab='', main='Leasing Rate for Green Buildings', xlab='')
hist(green_buildings_con$leasing_rate, breaks = 50, xlim=c(40, 100), ylab='', main='Leasing Rate for Green Buildings', xlab='')
hist(green_buildings_con$leasing_rate, breaks = 50, xlim=c(50, 100), ylab='', main='Leasing Rate for Green Buildings', xlab='')
